$(document).ready(function(){var e=document.getElementById("domain").getAttribute("value");function d(){$(".status").each(function(){$(this).text("trying")});var j=$("<div></div>").load(e+"/polr/updt?id="+$("#main-post-id").text()+"&page="+$("#page").text()+"&sort="+$("#sort").text()+"&flow="+$("#flow").text()+"#full",function(l,k,m){if(k=="error"){$(".status").each(function(){$(this).text(m.statusText)})}else{$("#main-post").replaceWith(j.find("#main-post-container").html());$("#replies").replaceWith(j.find("#replies-container").html());$("title").text(j.find("#main-post-title").text()+" ~ xarql");c();i();$(".status").each(function(){$(this).text(m.statusText)})}})}$(".update-button").each(function(){var j=$(this);j.on("click",function(){d()})});$("#post-form").submit(function(m){m.preventDefault();$(".status").each(function(){$(this).text("trying")});var j=$(this),o=j.find("input[name='title']").val(),l=j.find("textarea[name='content']").val(),n=j.find("input[name='answers']").val(),k=j.attr("action");j.trigger("reset");$("#replying-to-input").val(parseInt($("#main-post-id").text()));$.ajax({type:"POST",url:k,data:{title:o,content:l,answers:n,}}).done(function(){$(".status").each(function(){$(this).text("success");$("#advisory").text("Wait 20 seconds between posts");$("#advisory").show()})}).fail(function(){$(".status").each(function(){j.find("input[name='title']").val(o.trim());j.find("textarea[name='content']").val(l.trim());j.find("input[name='answers']").val(n);$(this).text("error");$("#advisory").text("Try reloading if posting fails. Remember to solve the Recaptcha.");$("#advisory").show()})}).always(function(){window.setTimeout(d,500)})});function nav(){$(".status").each(function(){$(this).text("trying")});var k=$("#nav-form"),m=$("#page-dropdown").val(),l=$("#sort-dropdown").val(),j=$("#flow-dropdown").val();var n=$("<div></div>").load(e+"/polr/updt?id="+$("#main-post-id").text()+"&page="+m+"&sort="+l+"&flow="+j,function(p,o,q){if(o=="error"){$(".status").each(function(){$(this).text(q.statusText)})}else{$("#main-post").replaceWith(n.find("#main-post-container").html());$("#replies").replaceWith(n.find("#replies-container").html());$("title").text(n.find("#main-post-title").text()+" ~ xarql");history.pushState("xarql","xarql",window.location.pathname+"?page="+m+"&sort="+l+"&flow="+j);$("#page").text(m);$("#sort").text(l);$("#flow").text(j);c();i();if(m>0){$("#prev-form").show();$("#prev-form").css("display","inline")}else{$("#prev-form").hide()}if(m<4){$("#next-form").show();$("#next-form").css("display","inline")}else{$("#next-form").hide()}$(".status").each(function(){$(this).text(q.statusText)});$("html, body").animate({scrollTop:0},"fast")}})}$("#nav-form").submit(function(j){j.preventDefault();nav()});$("#next-form").submit(function(j){j.preventDefault();var k=parseInt($("#page-dropdown").val());if(k<9){$("#page-dropdown").val(k+1)}nav()});$("#prev-form").submit(function(j){j.preventDefault();var k=parseInt($("#page-dropdown").val());if(k>0){$("#page-dropdown").val(k-1)}nav()});$("html").css("font-size",Cookies.get("font-size"));$("#text-up").on("click",function(){var j=parseFloat(window.getComputedStyle(document.getElementById("html")).fontSize);$("#font-size").remove();$("html").css("font-size",(j+1)+"px");Cookies.set("font-size",(j+1)+"px")});$("#text-dn").on("click",function(){var j=parseFloat(window.getComputedStyle(document.getElementById("html")).fontSize);$("#font-size").remove();$("html").css("font-size",(j-1)+"px");Cookies.set("font-size",(j-1)+"px")});var a=false;function g(l,j){$(".status").each(function(){$(this).text("trying")});var k=$("<div></div>").load(e+"/polr/updt?id="+l+"&page=0",function(n,m,o){if(m=="error"){$(".status").each(function(){$(this).text(o.statusText)})}else{$("#main-post").replaceWith(k.find("#main-post-container").html());$("#replies").replaceWith(k.find("#replies-container").html());$("title").text(k.find("#main-post-title").text()+" ~ xarql");if(j){}else{history.pushState("xarql","xarql",e+"/polr/"+l)}$(".status").each(function(){$(this).text(o.statusText)});$("html, body").animate({scrollTop:0},"fast");$("#replying-to-input").val(parseInt($("#main-post-id").text()));$("#page-dropdown").val(0);$("#prev-form").hide();$("#next-form").show();$("#next-form").css("display","inline");c();i()}})}function c(){$(".view-link").each(function(){$(this).unbind("click");$(this).on("click",function(){var j=$(this).attr("post-id");g(j,false);return false})})}c();window.addEventListener("popstate",function(k){var j=window.location.href.split("/");if(j[j.length-2]=="polr"){var l=j[j.length-1];if(l.includes("?")){window.location.href=window.location.href}else{g(l,true)}}else{window.location.href=window.location.href}},false);function b(j){if(j==="light"||j==="dark"||j==="rainbow"){}else{j="light"}$("#theme-styles").attr("href",e+"/src/common/"+j+"-common.min.css");Cookies.set("theme",j);$(".theme-button").show();$("#"+j+"-theme-button").hide()}b(Cookies.get("theme"));$(".theme-button").each(function(){var j=$(this);j.on("click",function(){b(j.attr("data"))})});function f(j){if(j==="light"){$("p").css("font-weight","200");$(".bold").css("font-weight","400");$("h6").css("font-weight","400");$("#font-light-button").hide();$("#font-normal-button").show();Cookies.set("font-weight","light")}else{$("p").css("font-weight","400");$(".bold").css("font-weight","600");$("h6").css("font-weight","600");$("#font-normal-button").hide();$("#font-light-button").show();Cookies.set("font-weight","normal")}}f(Cookies.get("font-weight"));$("#font-light-button").on("click",function(){f("light")});$("#font-normal-button").on("click",function(){f("normal")});$(".ajax-bar").each(function(){$(this).show()});$("#option-pane-open-button").on("click",function(){$("#option-pane").show();$("#option-pane-close-button").show();$(this).hide()});$("#option-pane-close-button").on("click",function(){$("#option-pane").hide();$("#option-pane-open-button").show();$(this).hide()});function h(j){$("#post-inner-"+j).show();$("#post-warning-"+j).hide()}function i(){$(".reveal-link").each(function(){var j=$(this);j.on("click",function(){h(j.attr("data"));j.hide()})})}i()});
