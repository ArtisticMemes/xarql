$(document).ready(function(){var e=document.getElementById("domain").getAttribute("value");function i(l){var o=decodeURIComponent(window.location.search.substring(1)),n=o.split("&"),p,m;for(m=0;m<n.length;m++){p=n[m].split("=");if(p[0]===l){return p[1]===undefined?true:p[1]}}}function d(){$(".status").each(function(){$(this).text("trying")});var l=$("<div></div>").load(e+"/polr/updt?id="+$("#main-post-id").text()+"&page="+$("#page").text()+"&sort="+$("#sort").text()+"&flow="+$("#flow").text()+"#full",function(n,m,o){if(m=="error"){$(".status").each(function(){$(this).text(o.statusText)})}else{$("#main-post").replaceWith(l.find("#main-post-container").html());$("#replies").replaceWith(l.find("#replies-container").html());$("title").text(l.find("#main-post-title").text()+" ~ xarql");c();k();$(".status").each(function(){$(this).text(o.statusText)})}})}var f=i("refresh");if(typeof f!="undefined"&&f==="true"){d();history.pushState("xarql","xarql",window.location.pathname)}$(".update-button").each(function(){var l=$(this);l.on("click",function(){d()})});$("#post-form").submit(function(o){o.preventDefault();$(".status").each(function(){$(this).text("trying")});var l=$(this),q=l.find("input[name='title']").val(),n=l.find("textarea[name='content']").val(),p=l.find("input[name='answers']").val(),m=l.attr("action");l.trigger("reset");$("#replying-to-input").val(parseInt($("#main-post-id").text()));$.ajax({type:"POST",url:m,data:{title:q,content:n,answers:p,}}).done(function(){$(".status").each(function(){$(this).text("success");$("#advisory").text("Wait 20 seconds between posts");$("#advisory").show()})}).fail(function(){$(".status").each(function(){l.find("input[name='title']").val(q);l.find("textarea[name='content']").val(n);l.find("input[name='answers']").val(p);$(this).text("error");$("#advisory").text("Try reloading if posting fails. Remember to solve the Recaptcha.");$("#advisory").show()})}).always(function(){window.setTimeout(d,500)})});function nav(){$(".status").each(function(){$(this).text("trying")});var m=$("#nav-form"),o=$("#page-dropdown").val(),n=$("#sort-dropdown").val(),l=$("#flow-dropdown").val();var p=$("<div></div>").load(e+"/polr/updt?id="+$("#main-post-id").text()+"&page="+o+"&sort="+n+"&flow="+l,function(r,q,s){if(q=="error"){$(".status").each(function(){$(this).text(s.statusText)})}else{$("#main-post").replaceWith(p.find("#main-post-container").html());$("#replies").replaceWith(p.find("#replies-container").html());$("title").text(p.find("#main-post-title").text()+" ~ xarql");history.pushState("xarql","xarql",window.location.pathname+"?page="+o+"&sort="+n+"&flow="+l);$("#page").text(o);$("#sort").text(n);$("#flow").text(l);c();k();if(o>0){$("#prev-form").show();$("#prev-form").css("display","inline")}else{$("#prev-form").hide()}if(o<4){$("#next-form").show();$("#next-form").css("display","inline")}else{$("#next-form").hide()}$(".status").each(function(){$(this).text(s.statusText)});$("html, body").animate({scrollTop:0},"fast")}})}$("#nav-form").submit(function(l){l.preventDefault();nav()});$("#next-form").submit(function(l){l.preventDefault();var m=parseInt($("#page-dropdown").val());if(m<9){$("#page-dropdown").val(m+1)}nav()});$("#prev-form").submit(function(l){l.preventDefault();var m=parseInt($("#page-dropdown").val());if(m>0){$("#page-dropdown").val(m-1)}nav()});$("html").css("font-size",Cookies.get("font-size"));$("#text-up").on("click",function(){var l=parseFloat(window.getComputedStyle(document.getElementById("html")).fontSize);$("#font-size").remove();$("html").css("font-size",(l+1)+"px");Cookies.set("font-size",(l+1)+"px")});$("#text-dn").on("click",function(){var l=parseFloat(window.getComputedStyle(document.getElementById("html")).fontSize);$("#font-size").remove();$("html").css("font-size",(l-1)+"px");Cookies.set("font-size",(l-1)+"px")});var a=false;function h(m){$(".status").each(function(){$(this).text("trying")});var l=$("<div></div>").load(e+"/polr/updt?id="+m+"&page=0",function(o,n,p){if(n=="error"){$(".status").each(function(){$(this).text(p.statusText)})}else{$("#main-post").replaceWith(l.find("#main-post-container").html());$("#replies").replaceWith(l.find("#replies-container").html());$("title").text(l.find("#main-post-title").text()+" ~ xarql");if(a){}else{history.pushState("xarql","xarql",e+"/polr/"+m)}$(".status").each(function(){$(this).text(p.statusText)});$("html, body").animate({scrollTop:0},"fast");$("#replying-to-input").val(parseInt($("#main-post-id").text()));$("#page-dropdown").val(0);$("#prev-form").hide();$("#next-form").show();$("#next-form").css("display","inline");c();k()}})}function c(){$(".view-link").each(function(){$(this).unbind("click");$(this).on("click",function(){var l=$(this).attr("post-id");h(l);return false})})}c();window.addEventListener("popstate",function(m){var l=window.location.href.split("/");var n=l[l.length-1];a=true;h(n);a=false},false);function b(l){if(l==="light"||l==="dark"||l==="purple"){}else{l="light"}$("#theme-styles").attr("href",e+"/src/common/"+l+"-common.min.css");Cookies.set("theme",l);$(".theme-button").show();$("#"+l+"-theme-button").hide()}b(Cookies.get("theme"));$(".theme-button").each(function(){var l=$(this);l.on("click",function(){b(l.attr("data"))})});function g(l){if(l==="light"){$("p").css("font-weight","200");$(".bold").css("font-weight","400");$("h6").css("font-weight","400");$("#font-light-button").hide();$("#font-normal-button").show();Cookies.set("font-weight","light")}else{$("p").css("font-weight","400");$(".bold").css("font-weight","600");$("h6").css("font-weight","600");$("#font-normal-button").hide();$("#font-light-button").show();Cookies.set("font-weight","normal")}}g(Cookies.get("font-weight"));$("#font-light-button").on("click",function(){g("light")});$("#font-normal-button").on("click",function(){g("normal")});$(".ajax-bar").each(function(){$(this).show()});$("#option-pane-open-button").on("click",function(){$("#option-pane").show();$("#option-pane-close-button").show();$(this).hide()});$("#option-pane-close-button").on("click",function(){$("#option-pane").hide();$("#option-pane-open-button").show();$(this).hide()});function j(l){$("#post-inner-"+l).show();$("#post-warning-"+l).hide()}function k(){$(".reveal-link").each(function(){var l=$(this);l.on("click",function(){j(l.attr("data"));l.hide()})})}k()});